name: Basic Info


on: 
  workflow_dispatch:
  push:
    branches:
     - main
      


jobs:
  display-info:
    runs-on: ubuntu-latest

    
    steps:
      - name: Start build process
        run: echo "Build process started..."

      - &echo-template
        name: Echo template
        run: echo "this is a reusable step"
        shell: bash

    
      - name: ğŸ–¥ï¸ Show GitHub Context
        run: |
          echo "ğŸ–¥ï¸ Runner OS: $RUNNER_OS"
          echo "ğŸ“‚ Repository: ${{ github.repository }}"
          echo "ğŸ”§ Workflow: ${{ github.workflow }}"
          echo  "ğŸš€ Triggered by: ${{ github.event_name }}"
          echo  "ğŸ‘¤ Actor: ${{ github.actor }}"
          echo  "ğŸ”¢ Run Number: ${{ github.run_number }}"
          echo  "ğŸŒ¿ Branch: ${GITHUB_REF#refs/heads/}"

          
      - *echo-template
      
  build-project:
    runs-on: ubuntu-latest

    steps: 
      - name: Checkout code
        uses: actions/checkout@v5.0.0

      - name: Install .NET 9
        uses: actions/setup-dotnet@v5.0.0
        with:
          dotnet-version: '9.0.x'

      - name: Build project
        working-directory: ./TodoApi
        run: dotnet build 

  count-lines:
    runs-on: ubuntu-latest

    steps:
      - name: Count lines
        run:  |
          echo "ğŸ“Š Lines of Code: $(find . \
          -type d \( -name node_modules -o -name .git -o -name dist -o -name bin -o -name obj \) -prune -false -o \
          -type f \( -name "*.cs" -o -name "*.ts" -o -name "*.tsx" \) \
          -exec cat {} + | wc -l)"


  count-lines-codestats:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout TodoApp repository
        uses: actions/checkout@v3

      - name: ğŸ§° Setup .NET SDK
        uses: actions/setup-dotnet@v3
        with:
          dotnet-version: '8.0.x'

      - name: ğŸ“¥ Clone codestats CLI to temp folder
        run: git clone https://github.com/n4sser77/codestats.git /tmp/codestats

      - name: ğŸ›  Build and pack codestats CLI
        working-directory: /tmp/codestats
        run: dotnet pack -c Release

      - name: ğŸ“¦ Install codestats CLI globally
        run: dotnet tool install --global codestats --add-source /tmp/codestats/bin/Release --version 0.0.2-pre

      - name: ğŸ§¹ Remove codestats temp folder before counting
        run: rm -rf /tmp/codestats

      - name: ğŸ“Š Run codestats CLI from repo root
        working-directory: ${{ github.workspace }}
        run: codestats cl -t cs,ts,tsx


  
   
    
